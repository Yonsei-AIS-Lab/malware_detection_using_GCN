from utils import *
from model import *

if __name__ == '__main__':
    file_name = './datasets/security_train.csv'
    data = pd.read_csv(file_name)

    nb_files, nb_data, nb_labels, nb_apis = get_data_info(data)
    processed_data = preprocessing_graph_data(data, nb_files)

    data_loader = DataLoader(processed_data, batch_size=16, shuffle=True)

    model = GCN(5, nb_labels)

    train(model, data_loader)