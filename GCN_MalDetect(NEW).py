import utils
import pandas as pd

def data_info(data):
    """
    0: Normal
    1: Extortion Virus
    2: Mining Program
    3: DDoS Trojan Horse
    4: Worm Virus
    5: Infectious Virus
    6: Backdoor Program
    7: Trojan horse Program
    """
    label = data.groupby(['file_id', 'label'])['label'].unique()
    counts = label.value_counts()
    features = data['api'].unique()
    files = data['file_id'].unique()

    nb_features = len(features)
    nb_data = len(data)
    nb_files = len(files)

    print(f"- Data     : {nb_data:<6}\n"
        f"- Features : {nb_features:<6}\n"
        f"- Files    : {nb_files:<6}\n")
    
    print(counts)

    return nb_features, nb_data, nb_files

if __name__ == '__main__':
    file_name = './datasets/sliced_train.csv'
    data = pd.read_csv(file_name)

    data_info(data)