from utils import *

def create_feature_matrix(files, api2idx):
    file_len = len(files)
    
    nb_features = len(api2idx)
    print('-----| Create Feature Matrix |-----')

    results = []
    for i, nodes in enumerate(files):
        feature = np.zeros(nb_features)
        for node in nodes:
            feature[node] += 1
        results.append(feature)
        print_progress(i, file_len)
    
    print('\n')

    return np.array(results)

def create_adj_matrix():
    pass

if __name__ == '__main__':
    file_name = './datasets/security_train_sliced_1000.csv'
    data = pd.read_csv(file_name)

    nb_features, nb_data, nb_files = get_data_info(data)

    data_split_per_id = split_per_id(data, nb_files)

    api2idx = creat_api2idx(data)

    files, labels = encode_api_name(data_split_per_id, api2idx)

    feature_mat = create_feature_matrix(files, api2idx)